load("Data/contact_all.rdata")
country<-"CMR"
m <- data.matrix(contact_all[[country]])

prem_new <- matrix(1:9, nrow = 3, ncol = 3)
colnames(prem_new) <- c("0-17", "18-55", "56-80")
rownames(prem_new) <- c("0-17", "18-55", "56-80")

#' V1: 0-5 V2: 6-10 V3: 11-15 V4: 16-20 v5: 21-25 etc.
#' Contacts of group 0-17:
a <- c(sum(m[1:3,1],2/5*m[4,1]),sum(m[1:3,2],2/5*m[4,2]),sum(m[1:3,3],2/5*m[4,3]),sum(m[1:3,4],2/5*m[4,4]))
prem_new[1,1] <- sum(15/17*mean(a[1],a[2],a[3]),2/17*a[4])
b <- c(sum(m[5:11,1],3/5*m[4,1]),sum(m[5:11,2],3/5*m[4,2]),sum(m[5:11,3],3/5*m[4,3]),sum(m[5:11,4],3/5*m[4,4]))
prem_new[2,1] <- sum(15/17*mean(b[1],b[2],b[3]),2/17*b[4])
d <- c(sum(m[12:16,1]),sum(m[12:16,2]),sum(m[12:16,3]),sum(m[12:16,4]))
prem_new[3,1] <- sum(15/17*mean(d[1:3]),2/17*d[4])

#'Contacts of group 18-55:
e<- c(sum(m[1:3,4],2/5*m[4,4]),sum(m[1:3,5],2/5*m[4,5]),sum(m[1:3,6],2/5*m[4,6]),sum(m[1:3,7],2/5*m[4,7]),sum(m[1:3,8],2/5*m[4,8]),sum(m[1:3,9],2/5*m[4,9]),sum(m[1:3,10],2/5*m[4,10]),sum(m[1:3,11],2/5*m[4,11]))
prem_new[1,2] <- sum(3/38*e[1],35/38*mean(e[2:8]))
f<- c(sum(m[5:11,4],3/5*m[4,4]),sum(m[5:11,5],3/5*m[4,5]),sum(m[5:11,6],3/5*m[4,6]),sum(m[5:11,7],3/5*m[4,7]),sum(m[5:11,8],3/5*m[4,8]),sum(m[5:11,9],3/5*m[4,9]),sum(m[5:11,10],3/5*m[4,10]),sum(m[5:11,11],3/5*m[4,11]))
prem_new[2,2] <- sum(3/38*f[1],35/38*mean(f[2:8]))
g<- c(sum(m[12:16,4]),sum(m[12:16,5]),sum(m[12:16,6]),sum(m[12:16,7]),sum(m[12:16,8]),sum(m[12:16,9]),sum(m[12:16,10]),sum(m[12:16,11]))
prem_new[3,2] <- sum(3/38*g[1],35/38*mean(g[2:8]))

#'Contacts of group 56-100:
h<- c(sum(m[1:3,12],2/5*m[4,12]),sum(m[1:3,13],2/5*m[4,13]),sum(m[1:3,14],2/5*m[4,14]),sum(m[1:3,15],2/5*m[4,15]),sum(m[1:3,16],2/5*m[4,16]))
prem_new[1,3] <- mean(h[1:5])
i<- c(sum(m[5:11,12],3/5*m[4,12]),sum(m[5:11,13],3/5*m[4,13]),sum(m[5:11,14],3/5*m[4,14]),sum(m[5:11,15],3/5*m[4,15]),sum(m[5:11,16],3/5*m[4,16]))
prem_new[2,3] <- mean(i[1:5])
j<- c(sum(m[12:16,12]),sum(m[12:16,13]),sum(m[12:16,14]),sum(m[12:16,15]),sum(m[12:16,16]))
prem_new[3,3] <- mean(j)

prem_new
